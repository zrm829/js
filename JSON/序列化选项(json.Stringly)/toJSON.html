<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>toJSON()方法 </title>
</head>

<body>
    <!-- 3. toJSON()方法
    有时候，JSON.stringify()还是不能满足对某些对象进行自定义序列化的需求。在这些情况下，
    可以给对象定义 toJSON()方法，返回其自身的 JSON 数据格式。原生 Date 对象有一个 toJSON()方法，
    能够将JavaScript的Date 对象自动转换成ISO 8601日期字符串（与在Date 对象上调用toISOString()
    的结果完全一样）。 -->
    <script>
        var book = {
            "title": "Professional JavaScript",
            "authors": [
                "Nicholas C. Zakas"
            ],
            edition: 3,
            year: 2011,
            toJSON: function () {
                return this.title;
                // return undefined;
            },
            // student:{
            //     name:'zrm',
            //     toJSON: function () {
            //         return undefined;
            //     },
            // }
        };
        // 序列化该对象的顺序如下。
        // (1) 如果存在 toJSON()方法而且能通过它取得有效的值，则调用该方法。否则，返回对象本身。
        // (2) 如果提供了第二个参数，应用这个函数过滤器。传入函数过滤器的值是第(1)步返回的值。
        // (3) 对第(2)步返回的每个值进行相应的序列化。
        // (4) 如果提供了第三个参数，执行相应的格式化

        var jsonText1 = JSON.stringify(book);
        console.log(jsonText1);  //"Professional JavaScript"

        var jsonText2 = JSON.stringify(book, ["edition"]);
        console.log(jsonText2);    //"Professional JavaScript"
    </script>
</body>

</html>